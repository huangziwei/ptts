#!/usr/bin/env bash
set -euo pipefail

image="ghcr.io/astral-sh/uv:python3.12-bookworm-slim"
if [ -n "${PMX_OPTS:-}" ]; then
  # shellcheck disable=SC2086
  exec podman run --rm -it \
    -v "$PWD":/work -w /work \
    -e HF_HOME=/work/.cache/huggingface \
    -e UV_CACHE_DIR=/work/.uv-cache \
    $PMX_OPTS \
    "$image" \
    "$@"
fi

exec podman run --rm -it \
  -v "$PWD":/work -w /work \
  -e HF_HOME=/work/.cache/huggingface \
  -e UV_CACHE_DIR=/work/.uv-cache \
  "$image" \
  "$@"
